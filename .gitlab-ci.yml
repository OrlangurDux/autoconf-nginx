image: golang:latest
stages:
  - deploy
before_script:
  - apt-get update -qq && apt-get install -y -qq sshpass
  - go get gopkg.in/yaml.v3
  - mkdir -p $(pwd)/build

deploy-dev:
  stage: deploy  
  script:
    - cd $(pwd)/src
    - go build -race -ldflags "-extldflags '-static'" -o $(pwd)/build/main
    - mv $(pwd)/build/main $(pwd)/build/autoconf-nginx
    - export SSHPASS=$USER_PSWD
<<<<<<< HEAD
    - cd $(pwd)/build
    - sshpass -e scp -P36702 -o StrictHostKeyChecking=no -r $(pwd) $USER_NAME@$SERVER_NAME:~/tools
=======
    - sshpass -e scp -P36702 -o StrictHostKeyChecking=no -r "$(pwd)/build/" $USER_NAME@$SERVER_NAME:~/tools
>>>>>>> e2367eeabe1358dd36c4febad0b3ae8a9a4f4c16
  only:
    - master

